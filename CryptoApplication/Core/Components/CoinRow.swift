//
//  CoinRow.swift
//  CryptoApplication
//
//  Created by mac on 15.12.2023.
//

import SwiftUI

struct CoinRow: View {
   var coin: CoinModel
   @State var showHoldings: Bool

   var body: some View {
      HStack {
         // Number
         Text("\(1)")
            .font(.caption)
            .foregroundStyle(Color.crp.accent)

         // Icon
         AsyncImage(url: URL(string: "\(coin.image)")!, scale: 2)
            .frame(width: 30, height: 30)
            .cornerRadius(50)

         // Name
         Text(coin.symbol.uppercased())
            .font(.headline)
            .foregroundColor(Color.crp.accent)

         Spacer()

         // Holding
         if showHoldings {
            VStack(alignment: .trailing) {
               Text(coin.currentHoldingsValue.asCurrencyWith6Decimals())
                  .foregroundStyle(Color.crp.accent)
                  .bold()

               Text((coin.currentHoldings ?? 0).asNumberString())
            }
         }

         // Price
         VStack(alignment: .trailing) {
            Text(coin.currentPrice.asCurrencyWith6Decimals())
               .bold()
               .foregroundStyle(Color.crp.accent)

            Text(coin.priceChangePercentage24HInCurrency?.asPresentStribg() ?? "non")
               .foregroundStyle(coin.priceChangePercentage24HInCurrency ?? 0 >= 0 ? Color.crp.green : Color.crp.red)
         }
         .frame(width: UIScreen.main.bounds.width / 3.5, alignment: .trailing)
      }
      .font(.subheadline)
   }
}

#Preview {
   // Example Data
   CoinRow(coin:
      CoinModel(
         id: "bitcoin",
         symbol: "btc",
         name: "Bitcoin",
         image: "https://assets.coingecko.com/coins/images/1/large/bitcoin.png?1696501400",
         currentPrice: 42856,
         marketCap: 839137627507,
         marketCapRank: 1,
         fullyDilutedValuation: 900456024270,
         totalVolume: 29440690921,
         high24H: 43329,
         low24H: 42068,
         priceChange24H: 462.63,
         priceChangePercentage24H: 1.09129,
         marketCapChange24H: 11480770337,
         marketCapChangePercentage24H: 1.38714,
         circulatingSupply: 19569962,
         totalSupply: 21000000,
         maxSupply: 21000000,
         ath: 69045,
         athChangePercentage: -37.89694,
         athDate: "2021-11-10T14:24:11.849Z",
         atl: 67.81,
         atlChangePercentage: 63134.84504,
         atlDate: "2013-07-06T00:00:00.000Z",
         lastUpdated: "2023-12-14T19:21:12.108Z",
         sparklineIn7D: SparklineIn7D(
            price: [
               43321.512329799174, 43288.23234764201, 43158.79442501625, 43234.89391741567, 43377.592325683276, 43166.048404404966, 43270.11955970747, 43382.56326133669, 43396.43772710228, 43512.27963831054,
               43389.520293612215, 43470.02565791358, 43427.5014450611, 43360.89817301741, 43207.56300245892, 43248.20340119713, 43174.14096733939, 43329.93272271259, 43659.830608952616, 43794.25619153226,
               43633.412709203716, 43937.59163050896, 43819.98586201575, 43832.78035618881, 43734.95670481345, 43871.06803558629, 43911.84414986522, 44304.29854895467, 44385.97528580486, 44252.83509521942,
               44158.48119026304, 44198.705818343165, 44108.697502579984, 44196.30077985671, 44154.298824625366, 44239.39526772252, 44290.2632794866, 44229.141019371375, 44204.4580785644, 43840.60632056117,
               43847.66351672282, 43853.63342948888, 43824.94502243738, 43899.368140170685, 44006.937503718174, 43949.441930030014, 44117.99323780744, 44017.79837995913, 43944.03423047422, 43965.949557801694,
               43945.693569809504, 43980.53017046564, 44006.302674216204, 43908.53000269771, 43714.93535399452, 43791.11048243972, 43802.145000795754, 43797.215945807526, 43845.42419301062, 43939.24408548624,
               43894.827602213125, 43917.5199241797, 43968.39740026597, 43787.873300938925, 43634.41192705681, 43715.96053031301, 43737.59599352967, 43812.044576847926, 43832.213030611165, 43864.44652833788,
               43935.43898772248, 43805.59128814079, 43792.2242364665, 43864.742796961626, 43798.29205483033, 43967.496154161665, 43812.09560255007, 43783.921845319455, 43757.959937619176, 43645.41521066105,
               43266.820817984015, 41977.79580342069, 42335.19287326501, 42170.359240455335, 41963.918435869426, 41983.16618652562, 42130.029010755534, 42203.07612417308, 42289.044855997876, 42384.16182852714,
               42345.67055988128, 42211.75130516923, 42070.62720658794, 41898.11604074295, 41862.78867550699, 41678.24259803585, 41332.88950352128, 40983.403277832826, 40753.09799675056, 40819.09242130922,
               41090.42517461659, 41259.3097335054, 41262.42774346128, 41657.03627972297, 41650.24315559637, 41841.00358261786, 41736.848805059926, 41515.07283688436, 41523.985629395705, 41651.730244341976,
               42013.95727808587, 42026.30464430417, 41842.45594603396, 41772.858482883326, 41609.024084227676, 41865.28359097863, 41862.05316636862, 41467.71365603181, 41298.866947463066, 41301.18543434075,
               40720.052615882276, 41251.16516288981, 41083.08102526008, 41234.11289620644, 41066.78005858458, 41243.529922413894, 41450.819387377436, 41402.20524534755, 41077.682664111395, 40987.371856768616,
               40804.87516728444, 40892.5456601397, 40961.11667003693, 40886.84969702335, 41108.21612991579, 41210.73220951229, 41202.76530861262, 41075.82122712554, 40959.7745311822, 41124.5699534689,
               41444.99746245883, 41425.82037999901, 41869.404129598704, 41844.2458858634, 42091.78246722764, 42074.91076481174, 42770.01584143941, 42856.79358974412, 43038.42897688392, 43044.914433991085,
               42885.34413554673, 42771.9634610874, 42851.56536198936, 42782.21089895684, 42703.38112158031, 42723.860398772296, 42766.04600099997, 42960.06086336163, 42902.33179390111, 42797.25427858573,
               42913.54272252713, 42977.850332594106, 43199.21674485783, 43109.29539903041, 42600.47961294108, 42526.25713180226, 42414.76106217256, 42608.2753512864,
            ]),
         priceChangePercentage24HInCurrency: 3952.64, currentHoldings: 1.5
      ), showHoldings: true
   )
}
